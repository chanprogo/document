
## Redis 持久化机制  

Redis 是一个支持持久化的内存数据库，通过持久化机制把内存中的数据同步到硬盘文件来保证数据持久化。  
当 Redis 重启后通过把硬盘文件重新加载到内存，就能达到恢复数据的目的。  
实现：单独创建 fork() 一个子进程，将当前父进程的数据库数据复制到子进程的内存中，然后由子进程写入到临时文件中，持久化的过程结束了，再用这个临时文件替换上次的快照文件，然后子进程退出，内存释放。  
 
RDB 是 Redis 默认的持久化方式。按照一定的时间周期策略 把内存的数据 以快照的形式 保存到硬盘的二进制文件。
即 Snapshot 快照存储，对应产生的数据文件为 dump.rdb，通过配置文件中的 save 参数来定义快照的周期。
（快照可以是其所表示的数据的一个副本，也可以是数据的一个复制品。）   

AOF：Redis 会将每一个收到的写命令都通过 Write 函数追加到文件最后，类似于 MySQL 的 binlog。当 Redis 重启是会通过 重新执行文件中保存的写命令 来在内存中 重建整个数据库的内容。   

当两种方式同时开启时，数据恢复 Redis 会优先选择 AOF 恢复。   